<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bricklink Studio Files</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #111;
        color: #eee;
        padding: 20px;
    }
    h2 {
        color: #6cf;
        margin-bottom: 20px;
    }

    /* Grid layout: 10 columns, auto rows */
    .grid {
        display: grid;
        grid-template-columns: repeat(10, 180px);
        gap: 20px;
    }

    .item {
        text-align: center;
        background: #222;
        padding: 10px;
        border-radius: 6px;
    }

    .item img {
        width: 180px;
        height: auto;
        border-radius: 4px;
        display: block;
        margin-bottom: 10px;
    }

    a {
        color: #9df;
        text-decoration: none;
        font-size: 14px;
        display: block;
        margin: 4px 0;
    }

    a:hover {
        text-decoration: underline;
    }
</style>
</head>
<body>

<h2>Bricklink Studio Models</h2>
<p>Loading previewsâ€¦</p>

<div id="grid" class="grid"></div>

<script>
const apiURL = "https://api.github.com/repos/Jaseman125/lego/contents/bricklink-studio-files";

fetch(apiURL)
    .then(response => response.json())
    .then(items => {
        const grid = document.getElementById("grid");
        grid.innerHTML = "";

        // Build a map of files by extension
        const pngFiles = items.filter(f => f.name.toLowerCase().endsWith(".png"));
        const ioFiles = items.filter(f => f.name.toLowerCase().endsWith(".io"));

        // Create a lookup for .io files by base name
        const ioMap = {};
        ioFiles.forEach(file => {
            const base = file.name.replace(/\.io$/i, "");
            ioMap[base] = file.download_url;
        });

        // For each PNG, create a grid item
        pngFiles.forEach(png => {
            const base = png.name.replace(/\.png$/i, "");
            const ioURL = ioMap[base] || null;

            const div = document.createElement("div");
            div.className = "item";

            // Preview image
            const img = document.createElement("img");
            img.src = png.download_url;
            img.alt = base;
            div.appendChild(img);

            // View full-size PNG
            const viewLink = document.createElement("a");
            viewLink.href = png.download_url;
            viewLink.target = "_blank";
            viewLink.textContent = "View Full Size";
            div.appendChild(viewLink);

            // Download .io file (only if exists)
            if (ioURL) {
                const ioLink = document.createElement("a");
                ioLink.href = ioURL;
                ioLink.textContent = "Download .io File";
                div.appendChild(ioLink);
            }

            grid.appendChild(div);
        });
    })
    .catch(err => {
        document.getElementById("grid").innerHTML =
            "<p>Error loading files from GitHub.</p>";
        console.error(err);
    });
</script>

</body>
</html>
